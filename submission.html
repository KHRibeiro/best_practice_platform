<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="style.css" rel="stylesheet"/>
<title>Submit Practice - Best Practices Platform</title>
<style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f4f6f8;
    }
    header {
      background: #2c3e50;
      color: white;
      padding: 1rem;
      text-align: center;
    }
    nav {
      background: #34495e;
      padding: 0.5rem;
      display: flex;
      justify-content: center;
      gap: 1rem;
    }
    nav a {
      color: white;
      text-decoration: none;
      font-weight: bold;
    }
    main {
      padding: 2em;
    }
    form label {
      display: block;
      margin: 1em 0 0.5em;
    }
    input[type="text"], textarea, select {
      width: 100%;
      padding: 0.5em;
      margin-bottom: 1em;
    }
    input[type="file"] {
      margin-bottom: 1em;
    }
    .checkbox-group {
      margin-bottom: 1em;
    }
    .checkbox-group label {
      display: inline-block;
      margin-right: 1em;
    }
    .readonly {
      background-color: #e9ecef;
    }
    button {
      padding: 0.75em 1.5em;
      background-color: #008866;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #006655;
    }
  </style>
<style>
form {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  background-color: #f9f9f9;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

input, select, textarea {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

label {
  font-weight: bold;
  display: block;
  margin-bottom: 5px;
}

button, input[type="submit"] {
  background-color: #007bff;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

button:hover, input[type="submit"]:hover {
  background-color: #0056b3;
}
</style>
</head>
<body>
<header>
<img alt="Best Practice Platform Logo" src="jpeg (2).jpg" style="height:150px; background-color:transparent;"/>
<h1>Submit a Best Practice</h1>
</header>
<nav>
<a href="index.html">Dashboard</a>
<a href="library.html">Library</a>
<a href="submission.html">Submit</a>
<a href="tracker.html">Tracker</a>
<a href="audit.html">Audit</a>
<a href="admin.html">Admin</a>
<a href="login.html" style="float:right;">Login</a>
</nav>
<div id="user-info" style="text-align:right; padding: 0.5em; font-size: 0.9em;"></div>
<main>
<form action="https://formsubmit.co/kassio.ribeiro@gknpm.com" enctype="multipart/form-data" method="POST">
<label for="title">Title *</label>
<input id="title" name="title" required="" type="text"/>
<label for="description">Description *</label>
<textarea id="description" name="description" required="" rows="4"></textarea>
<label for="category">Category *</label>
<select id="category" name="category" required="">
<option value="">Select</option>
<option value="Quality">Quality</option>
<option value="Safety">Safety</option>
<option value="Efficiency">Efficiency</option>
</select>
<label for="area">Functional Area *</label>
<select id="area" name="area" required="">
<option value="">Select</option>
<option value="Production">Production</option>
<option value="Logistics">Logistics</option>
<option value="Finance">Finance</option>
</select>
<label for="region">Region / Plant *</label>
<select id="region" name="region" required="">
<option value="">Select</option>
<option value="Plant A">Plant A</option>
<option value="Plant B">Plant B</option>
<option value="Plant C">Plant C</option>
</select>
<label for="Applicability">Applicability *</label>
<select id="applicability" name="applicability" required="">
<option value="">Select</option>
<option value="Local">Local</option>
<option value="Regional">Regional</option>
<option value="Global">Global</option>
</select>
<label for="responsible">Responsible *</label>
<input id="responsible" name="responsible" required="" type="text"/>
<label for="status">Status *</label>
<select id="status" name="status" required="">
<option value="">Select</option>
<option value="Draft">Draft</option>
<option value="Under Review">Under Review</option>
<option value="Approved">Approved</option>
<option value="Implemented">Implemented</option>
</select>
<label for="documents">Supporting Documents</label>
<input id="documents" multiple="" name="documents" type="text"/>
<label for="kpis">Expected KPIs</label>
<textarea id="kpis" name="kpis" placeholder="E.g., Time reduction (10%), Productivity increase (15%)" rows="2"></textarea>
<label for="created">Creation Date *</label>
<input id="created" name="created" type="text"/>
<label for="history">Version History *</label>
<input id="history" name="history" type="text"/>
    
<button type="submit">Submit</button>
</form>
</main>
    
<script>
    function capitalize(str) {
      if (!str) return "";
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    const user = localStorage.getItem("username");
    const role = localStorage.getItem("userRole");
    if (user && role) {
      const formattedUser = capitalize(user);
      const formattedRole = capitalize(role);
      document.getElementById("user-info").textContent = `Logged in as: ${formattedUser} (${formattedRole})`;
    }

    // Preencher data de criação automaticamente
    document.getElementById("created").value = new Date().toLocaleDateString();
  </script>

<script type="module">
    const SUPABASE_URL = 'https://qnxvprptwczutzojjyve.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFueHZwcnB0d2N6dXR6b2pqeXZlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM3MzIxMjAsImV4cCI6MjA2OTMwODEyMH0.oBi3ZBvEIBUzsaAPvYRJIhAZlJuetYVMcxFTRs_gBio';

    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    document.addEventListener('DOMContentLoaded', () => {
      const form = document.querySelector('form');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const data = {
          title: form.querySelector('[name="title"]').value,
          description: form.querySelector('[name="description"]').value,
          category: form.querySelector('[name="category"]').value,
          functional_area: form.querySelector('[name="functional_area"]').value,
          region_plant: form.querySelector('[name="region_plant"]').value,
          applicability: form.querySelector('[name="applicability"]').value,
          responsible: form.querySelector('[name="responsible"]').value,
          status: form.querySelector('[name="status"]').value,
          documents: form.querySelector('[name="documents"]').value,
          kpis: form.querySelector('[name="kpis"]').value,
          creation_date: form.querySelector('[name="creation_date"]').value,
          version_history: form.querySelector('[name="version_history"]').value,
        };

        const { error } = await supabase.from('submissions').insert([data]);

        if (error) {
          alert('Erro ao enviar: ' + error.message);
        } else {
          alert('Submissão enviada com sucesso!');
          form.reset();
        }
      });
    });
  </script>
</body>
</html>
